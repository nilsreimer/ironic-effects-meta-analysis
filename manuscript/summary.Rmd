---
title: "Meta-analysis of the `ironic' effects of intergroup contact"
author: 
  - Nils Karl Reimer, University of Oxford
  - Nikhil Kumar Sengupta, University of Kent
date: "12/08/2020"
output:
  pdf_document:
    keep_tex: true
---

```{r setup, include = FALSE}

  knitr::opts_chunk$set(echo = FALSE)
  
  # Load packages
  library(tidyverse); library(numform)

```

# Results

## Preregistered analyses

```{r, include = FALSE}

  # Summarise results
  results <- read_rds("../results/results_preregistered_analyses.rds") %>% 
    pivot_longer(
      c(r_mean, tau_ii, tau_jj),
      names_to = "parameter",
      values_to = "estimate",
      values_drop_na = TRUE
    ) %>% 
    group_by(x_var, y_var, parameter) %>% 
    summarize(
      I = f_comma(unique(I)),
      J = f_comma(unique(J)),
      N = f_comma(unique(N)),
      median = median(estimate),
      .lower = quantile(estimate, 0.025),
      .upper = quantile(estimate, 0.975),
      p_below = mean(estimate < 0),
      p_above = mean(estimate > 0)
    ) %>% 
    ungroup() %>% 
    mutate(
      across(
        c(median, .lower, .upper), 
        ~f_num(., digits = 2)
      ),
      across(
        c(p_below, p_above), 
        ~case_when(
          . < .001 ~ "$<0.1\\%$",
          . > .999 ~ "$>99.9\\%$",
          TRUE ~ paste0("$", f_num(. * 100, digits = 1), "\\%$")
        )
      ),
      text = case_when(
        parameter == "r_mean" ~ paste0("$r = ", median, ", [", .lower, ",", .upper, "]$"),
        parameter == "tau_ii" ~ paste0("$\\tau_I = ", median, ", [", .lower, ",", .upper, "]$"),
        parameter == "tau_jj" ~ paste0("$\\tau_J = ", median, ", [", .lower, ",", .upper, "]$")
      )
    ) %>% 
    select(-median, -.lower, -.upper)

```

```{r, include = FALSE}
pi_results <- results %>% filter(x_var == "ic", y_var == "pi")
ca_results <- results %>% filter(x_var == "ic", y_var == "ca")
ps_results <- results %>% filter(x_var == "ic", y_var == "ps")
````

As preregistered, we ran three random-effects meta-analysis models, one for the relationship between intergroup contact and each outcome variable. Across `r unique(pi_results$N)` participants from `r unique(pi_results$I)` samples in `r unique(pi_results$J)` studies, we found strong evidence for a weak association (`r pi_results$text[pi_results$parameter == "r_mean"]`) between intergroup contact and perceived injustice, with `r pi_results$p_below[pi_results$parameter == "r_mean"]` of posterior samples for the mean correlation coefficient falling below zero. We found evidence that correlation coefficients varied across studies (`r pi_results$text[pi_results$parameter == "tau_jj"]`) and across samples within studies  (`r pi_results$text[pi_results$parameter == "tau_ii"]`). Across `r unique(ca_results$N)` participants from `r unique(ca_results$I)` samples in `r unique(ca_results$J)` studies, we found some evidence for a weak association (`r ca_results$text[ca_results$parameter == "r_mean"]`) between intergroup contact and collective action, with `r ca_results$p_below[ca_results$parameter == "r_mean"]` of posterior samples for the mean correlation coefficient falling below zero. We found evidence that correlation coefficients varied across studies (`r ca_results$text[ca_results$parameter == "tau_jj"]`) and across samples within studies  (`r ca_results$text[ca_results$parameter == "tau_ii"]`). Across `r unique(ps_results$N)` participants from `r unique(ps_results$I)` samples in `r unique(ps_results$J)` studies, we found some evidence for a weak association (`r ps_results$text[ps_results$parameter == "r_mean"]`) between intergroup contact and policy support, with `r ps_results$p_below[ps_results$parameter == "r_mean"]` of posterior samples for the mean correlation coefficient falling below zero. We found evidence that correlation coefficients varied across studies (`r ps_results$text[ps_results$parameter == "tau_jj"]`) and, to a lesser extent, across samples within studies  (`r ps_results$text[ps_results$parameter == "tau_ii"]`).

```{r, include = FALSE}
pi_ca_results <- results %>% filter(x_var == "pi", y_var == "ca", parameter == "r_mean")
pi_ps_results <- results %>% filter(x_var == "pi", y_var == "ps", parameter == "r_mean")
ca_ps_results <- results %>% filter(x_var == "ca", y_var == "ps", parameter == "r_mean")
````

As preregistered, we ran another three random-effects meta-analysis models to estimate the relationships between the three outcome variables. As we were not interested in the direction of these relationships, we used cross-sectional correlation coefficients as effect sizes for longitudinal studies. Across `r pi_ca_results$N` participants from `r pi_ca_results$I` samples in `r pi_ca_results$J` studies, we found evidence for a moderate association (`r pi_ca_results$text`) between perceived injustice and collective action. Across `r pi_ps_results$N` participants from `r pi_ps_results$I` samples in `r pi_ps_results$J` studies, we found evidence for a moderate association (`r pi_ps_results$text`) between perceived injustice and policy support. Across `r ca_ps_results$N` participants from `r ca_ps_results$I` samples in `r ca_ps_results$J` studies, we found evidence for a moderate association (`r ca_ps_results$text`) between collective action and policy support.
